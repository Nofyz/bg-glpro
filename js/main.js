const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/parallax-Bnwz7UnT.css","assets/index-DdztCYrB.css","assets/animations-interactions-VUa0f2IU.css","assets/debug-window-D0WOn1yS.css"])))=>i.map(i=>d[i]);
import{t as trackEvent,a as trackPurchase,b as trackMetaEvent,c as trackGAEvent,d as trackCustomEvent,e as elVisible,w as waitForVisible,T as TrackingListeners,s as sendViewportTimeEvent,f as watchBuyButtons,g as startTracking,h as sendPageViewEvent,i as sendPageExitEvent,j as sendPageScrollEvent,k as sendClickEvent,l as check_cookie,m as get_cookie$1,n as set_cookie,o as sendFunnelNodeEvent}from"./utils-PVgNhe_D.js";const scriptRel=function(){const t=typeof document<"u"&&document.createElement("link").relList;return t&&t.supports&&t.supports("modulepreload")?"modulepreload":"preload"}(),assetsURL=function(t){return"https://elasticfunnels.b-cdn.net/web/build/"+t},seen={},__vitePreload=function(t,i,o){let n=Promise.resolve();if(i&&i.length>0){document.getElementsByTagName("link");const r=document.querySelector("meta[property=csp-nonce]"),l=r?.nonce||r?.getAttribute("nonce");n=Promise.allSettled(i.map(c=>{if((c=assetsURL(c))in seen)return;seen[c]=!0;const s=c.endsWith(".css"),p=s?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${p}`))return;const d=document.createElement("link");return d.rel=s?"stylesheet":scriptRel,s||(d.as="script"),d.crossOrigin="",d.href=c,l&&d.setAttribute("nonce",l),document.head.appendChild(d),s?new Promise((u,m)=>{d.addEventListener("load",u),d.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${c}`)))}):void 0}))}function a(r){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=r,window.dispatchEvent(l),!l.defaultPrevented)throw r}return n.then(r=>{for(const l of r||[])l.status==="rejected"&&a(l.reason);return t().catch(a)})};let lastListenerInfo=new Array;function addCustomEventListener(t,i,o){t&&(t.addEventListener(i,o),lastListenerInfo.push({el:t,e:i}))}if(HTMLAnchorElement.prototype.realAddEventListener=HTMLAnchorElement.prototype.addEventListener,window.dc===1){let t=document.querySelector("body");t.style.webkitUserSelect="none",t.style.MozUserSelect="none",t.style.msUserSelect="none",t.style.userSelect="none",document.addEventListener("contextmenu",function(i){i.preventDefault()}),document.onkeydown=function(i){return i.keyCode!==123&&(!i.ctrlKey||!i.shiftKey||i.keyCode!==73)&&(!i.ctrlKey||!i.shiftKey||i.keyCode!==67)&&(!i.ctrlKey||!i.shiftKey||i.keyCode!==74)&&(!i.ctrlKey||i.keyCode!==85)&&void 0}}function elementEvents(t){let i=document.querySelector(t);i&&i.scrollIntoView({behavior:"smooth"})}function showElement(t){let i=document.querySelector(t);i&&(i.dataset.display&&i.dataset.display!=="none"?i.style.display=i.dataset.display:i.style.display="block")}function hideElement(t){let i=document.querySelector(t);i&&(i.dataset.display=i.style.display,i.style.display="none")}document.querySelectorAll("lazy-load-container").forEach(t=>{let i=t.getAttribute("data-delay")||0,o=t.getAttribute("id");setTimeout(()=>{(function(n){let a=window.location.href,r=new URL(a);r.searchParams.set("lzid",n),fetch(r.toString()).then(l=>l.text()).then(l=>{let c=document.getElementById(n),s=document.createElement("div");s.id=n,s.innerHTML=l,c.replaceWith(s)})})(o)},i)});const getCurrentDevice=function(){return window.matchMedia("(max-width: 575px)").matches?"mobilePortrait":window.matchMedia("(max-width: 992px)").matches?"tablet":"desktop"},shouldExecuteInteraction=function(t,i){if(t.action==="disabled")return!1;const o=r=>r==="mobile"?"mobilePortrait":r,n=o(t.device||"desktop"),a=o(i);return n==="desktop"?["desktop","tablet","mobilePortrait"].includes(a):n==="tablet"?["tablet","mobilePortrait"].includes(a):n==="mobilePortrait"&&a==="mobilePortrait"};let timeOnPage$1=0;setInterval(()=>{document.hasFocus()&&timeOnPage$1++},1e3);const triggerGoalAction=function(t,i){let o=i.closest("[data-sid]"),n={fid:window.fid,fnid:window.fnid,pgid:window.pgid,bid:window.bid,sid:o?o.getAttribute("data-sid"):void 0,cid:o?o.getAttribute("data-cid"):void 0,url:window.location.href,time:timeOnPage$1,goal_value:typeof t.data=="object"?decodeURIComponent(t.data.value):decodeURIComponent(t.data)};trackCustomEvent(t.action,n)},showModal=function(t,i){let o=document.querySelector(`#${t.data.modal_id}`);o&&(o.style.display="block")},hideModal=function(t,i){let o=document.querySelector(`#${t.data.modal_id}`);o&&(o.style.display="none")};function trackSplitTestViews(){document.querySelectorAll("[data-sid]").forEach(t=>{t.getAttribute("data-split-test-view-tracked")||(elVisible(t)?(trackSplitTest(t),t.setAttribute("data-split-test-view-tracked",!0)):waitForVisible(t).then(()=>{trackSplitTest(t),t.setAttribute("data-split-test-view-tracked",!0)}))})}function trackSplitTest(t){trackCustomEvent("split-test-view",{fid:window.fid,fnid:window.fnid,pgid:window.pgid,bid:window.bid,sid:t.getAttribute("data-sid"),cid:t.getAttribute("data-cid"),url:window.location.href})}window.trackInteraction=function(interaction){const currentDevice=getCurrentDevice();if(interaction.device||(interaction.device="desktop"),console.log("Processing interaction:",{ccid:interaction.ccid,action:interaction.action,type:interaction.type,device:interaction.device,currentDevice,shouldExecute:shouldExecuteInteraction(interaction,currentDevice)}),!shouldExecuteInteraction(interaction,currentDevice))return void console.log("Skipping interaction due to device mismatch");let els=[];els=(interaction.type,document.querySelectorAll(`#${interaction.ccid}`)),console.log(`Found ${els.length} elements for ccid: ${interaction.ccid}`),els.length!==0?els.forEach(el=>{const targetValue=interaction.data?.value||"none";let sanitizedTarget=targetValue;sanitizedTarget=interaction.action==="execute-js"||targetValue.length>50?btoa(targetValue.substring(0,100)).replace(/[^a-zA-Z0-9]/g,"").substring(0,20):targetValue.replace(/[^a-zA-Z0-9\-_]/g,"");const interactionId=`${interaction.type}-${interaction.ccid}-${interaction.action}-${sanitizedTarget}`;if(console.log("Setting up interaction:",{interactionId,action:interaction.action,target:targetValue,alreadyExists:el.hasAttribute(`data-interaction-${interactionId}`)}),el.hasAttribute(`data-interaction-${interactionId}`))return void console.log("Skipping duplicate interaction:",interactionId);el.setAttribute(`data-interaction-${interactionId}`,"true");let callback=(interaction,el,e=null)=>{if(console.log("Executing interaction callback:",{action:interaction.action,ccid:interaction.ccid,type:interaction.type,triggerElement:el,targetValue:interaction.data?.value||"none",interactionData:interaction.data}),interaction.type==="click"&&e&&(["show_element","hide_element","visibility-toggle"].includes(interaction.action)&&e.stopPropagation(),el.tagName==="A"&&el.href&&el.href.startsWith("javascript:")&&e.preventDefault()),interaction.action.startsWith("animate-"))window.animationInteractions&&window.animationInteractions.executeAnimation?window.animationInteractions.executeAnimation(interaction,el):console.warn("Animation interaction attempted but animation system not loaded");else{if(interaction.action==="split-test-goal"&&triggerGoalAction(interaction,el),interaction.action==="show_modal"&&showModal(interaction),interaction.action==="hide_modal"&&hideModal(interaction),interaction.action==="track-event"&&trackEvent(interaction.data.event_name||interaction.data),interaction.action==="purchase"&&trackPurchase(interaction.data),interaction.action==="custom-meta-event"&&trackMetaEvent(interaction.data.name,interaction.data.value??null),interaction.action==="custom-ga-event"&&trackGAEvent(interaction.data.name,interaction.data.value??null),interaction.action==="focus-on-element"&&elementEvents(interaction.data.value),interaction.action==="execute-js")try{eval(interaction.data.value)}catch(t){console.error("Error executing JS:",t)}if(interaction.action==="show_element"){const t=document.querySelector(interaction.data.value);console.log(`Showing element: ${interaction.data.value}`,{targetExists:!!t,targetElement:t});try{showElement(interaction.data.value),console.log(`showElement completed for: ${interaction.data.value}`)}catch(i){console.error(`showElement failed for: ${interaction.data.value}`,i)}}if(interaction.action==="hide_element"){const t=document.querySelector(interaction.data.value);console.log(`Hiding element: ${interaction.data.value}`,{targetExists:!!t,targetElement:t}),hideElement(interaction.data.value)}if(interaction.action==="visibility-toggle"){const t=document.querySelector(interaction.data.value);if(t){const i=window.getComputedStyle(t).display,o=i==="none"?"block":"none";console.log(`Toggling visibility for: ${interaction.data.value}`,{currentDisplay:i,newDisplay:o,targetElement:t}),t.style.display=o}else console.warn(`Target element not found for visibility-toggle: ${interaction.data.value}`)}interaction.action!=="disabled"||console.log(`Interaction disabled for ${getCurrentDevice()}: ${interaction.ccid}`)}};interaction.type==="load"?window.addEventListener("load",()=>{callback(interaction,el)},{once:!0}):interaction.type==="hover"?addCustomEventListener(el,"mouseenter",t=>{callback(interaction,el,t)}):interaction.type==="blur"?(el.tabIndex===-1&&(el.tabIndex=0),addCustomEventListener(el,"blur",t=>{callback(interaction,el,t)}),addCustomEventListener(el,"mouseleave",t=>{callback(interaction,el,t)})):interaction.type==="on-form-submit"?el.tagName==="FORM"&&addCustomEventListener(el,"submit",t=>{callback(interaction,el,t)}):interaction.type==="on-form-success"?document.addEventListener("on-form-success",t=>{t.detail&&t.detail.form===el&&callback(interaction,el,t)}):interaction.type==="on-form-error"?document.addEventListener("on-form-error",t=>{t.detail&&t.detail.form===el&&callback(interaction,el,t)}):(interaction.type,console.log(`Adding ${interaction.type} listener for ${interaction.ccid} -> ${interaction.action} (${interaction.data?.value})`),addCustomEventListener(el,interaction.type,t=>{console.log(`Event fired for ${interaction.ccid}: ${interaction.action} -> ${interaction.data?.value}`),callback(interaction,el,t)}),interaction.type==="click"&&addCustomEventListener(el,"touchstart",t=>{console.log(`Touch event fired for ${interaction.ccid}: ${interaction.action} -> ${interaction.data?.value}`),callback(interaction,el,t)}))}):console.warn(`No elements found for interaction: ${interaction.ccid}`)},document.addEventListener("DOMContentLoaded",function(){const t=getCurrentDevice();console.log("Current device detected:",t),console.log("Total interactions found:",window.int?window.int.length:0);const i=new Set;let o;window.int.forEach(n=>{if(n.device||(n.device="desktop"),(n.device==="mobile"?"mobilePortrait":n.device)===t&&n.action==="disabled"){const a=`${n.ccid}-${n.type}`;i.add(a),console.log(`Disabled trigger found: ${a}`)}}),window.int.forEach(n=>{const a=`${n.ccid}-${n.type}`;i.has(a)?console.log(`Skipping disabled trigger: ${a}`):n.action!=="disabled"&&shouldExecuteInteraction(n,t)&&(console.log("Processing cascaded interaction:",{ccid:n.ccid,type:n.type,action:n.action,device:n.device,currentDevice:t}),trackInteraction(n))}),window.addEventListener("resize",()=>{clearTimeout(o),o=setTimeout(()=>{const n=getCurrentDevice();n!==t&&(console.log("Device changed from",t,"to",n),t=n,function(){console.log("Reinitializing interactions for device:",t),window.int&&window.int.forEach(a=>{shouldExecuteInteraction(a,t)&&document.querySelectorAll(`#${a.ccid}`).forEach(r=>{const l=a.data?.value||"none";let c=l;c=a.action==="execute-js"||l.length>50?btoa(l.substring(0,100)).replace(/[^a-zA-Z0-9]/g,"").substring(0,20):l.replace(/[^a-zA-Z0-9\-_]/g,"");const s=`${a.type}-${a.ccid}-${a.action}-${c}`;r.hasAttribute(`data-interaction-${s}`)||(console.log("Adding interaction for new device:",s),trackInteraction(a))})}),console.log("Interactions reinitialized for device:",t)}(),window.mobileExitIntentDeviceChange&&window.mobileExitIntentDeviceChange(n))},250)})}),window.overrideDesktopTrigger=function(t,i=null){if(!window.int)return void console.warn("No interactions array found");let o=getCurrentDevice();o==="mobile"&&(o="mobilePortrait");const n=i||t.ccid,a={...JSON.parse(JSON.stringify(t)),device:o,ccid:n,data:t.data?JSON.parse(JSON.stringify(t.data)):{data:1}};return window.int.push(a),trackInteraction(a),console.log(`Override trigger created for ${n} on ${o}:`,a),a},window.disableDesktopTrigger=function(t,i=null){if(!window.int)return void console.warn("No interactions array found");let o=getCurrentDevice();o==="mobile"&&(o="mobilePortrait");const n=i||t.ccid,a={type:t.type,action:"disabled",device:o,ccid:n,is_component:t.is_component||!1,data:{disabled:!0}};return window.int.push(a),console.log(`Disable trigger created for ${n} on ${o}:`,a),a},window.getCascadedTriggers=function(t){if(!window.int||!t)return[];const i=getCurrentDevice();let o=i;if(o==="mobile"&&(o="mobilePortrait"),o==="desktop")return[];const n=window.int.filter(c=>c.ccid===t),a=[],r=new Set,l=new Set;return n.forEach(c=>{let s=c.device||"desktop";s==="mobile"&&(s="mobilePortrait"),s===o&&(c.action==="disabled"?l.add(c.type):r.add(c.type))}),n.forEach(c=>{let s=c.device||"desktop";s==="mobile"&&(s="mobilePortrait"),!(s===o||c.action==="disabled")&&shouldExecuteInteraction(c,i)&&(r.has(c.type)||l.has(c.type)||a.push(c))}),a},window.isTriggerDisabled=function(t,i){if(!window.int)return!1;let o=getCurrentDevice();return o==="mobile"&&(o="mobilePortrait"),window.int.some(n=>{let a=n.device||"desktop";return a==="mobile"&&(a="mobilePortrait"),n.ccid===t&&n.type===i&&n.action==="disabled"&&a===o})},window.removeInteraction=function(t){if(!window.int)return!1;const i=window.int.length;window.int=window.int.filter(n=>!(n.ccid===t.ccid&&n.type===t.type&&n.action===t.action&&n.device===t.device)),window.getCurrentDevice=getCurrentDevice;const o=window.int.length!==i;return o&&console.log("Removed interaction:",t),o},window.getCurrentDevice=getCurrentDevice,window.shouldExecuteInteraction=shouldExecuteInteraction,document.addEventListener("DOMContentLoaded",function(){setTimeout(()=>{trackSplitTestViews()},100)});class SeedInstructionsAlert{constructor(){this.instructions=window.seed_instructions||[],this.alertShown=!1,this.init()}init(){this.instructions.length>0&&!this.alertShown&&(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>this.showAlert()):this.showAlert())}showAlert(){const i=`
            <div style="
                position: fixed;
                top: 20px;
                right: 20px;
                max-width: 400px;
                background: #f8f9fa;
                border: 2px solid #007bff;
                border-radius: 8px;
                padding: 20px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                z-index: 10000;
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
                font-size: 14px;
                line-height: 1.5;
            ">
                <div style="
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    margin-bottom: 15px;
                ">
                    <h4 style="
                        margin: 0;
                        color: #007bff;
                        font-size: 16px;
                        font-weight: 600;
                    ">📋 Funnel Instructions</h4>
                    <button onclick="this.parentElement.parentElement.remove()" style="
                        background: none;
                        border: none;
                        font-size: 18px;
                        cursor: pointer;
                        color: #6c757d;
                        padding: 0;
                        width: 24px;
                        height: 24px;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                    ">&times;</button>
                </div>
                <div style="color: #495057;">
                    <p style="margin: 0 0 10px 0; font-weight: 500;">Next steps to follow:</p>
                    <ul style="margin: 0; padding-left: 20px;">
                        ${this.instructions.map(n=>`<li style="margin-bottom: 8px;">${this.escapeHtml(n)}</li>`).join("")}
                    </ul>
                </div>
            </div>
        `,o=document.createElement("div");o.innerHTML=i,document.body.appendChild(o),this.alertShown=!0,setTimeout(()=>{o.parentNode&&o.remove()},3e4),console.log("Seed Instructions Alert displayed:",this.instructions)}escapeHtml(i){const o=document.createElement("div");return o.textContent=i,o.innerHTML}}typeof window<"u"&&(window.seedInstructionsAlert=new SeedInstructionsAlert),document.querySelector("*[data-youtube-code], *[data-direct-link]"),window.onload=function(){document.querySelectorAll('*[data-page-modal="open"]').forEach(function(t){let i=t.getAttribute("data-page-id"),o="/"+i,n=document.createElement("div");n.setAttribute("id",`modal_${i}`),n.style.position="fixed",n.style.zIndex="9999",n.style.width="100%",n.style.height="100%",n.style.overflow="none",n.style.top=0,n.style.display="none";let a=document.createElement("iframe");a.setAttribute("src",o),a.style.width="100%",a.style.height="100%",a.style.border="none",n.appendChild(a),document.body.appendChild(n),t.addEventListener("click",function(r){r.preventDefault(),document.getElementsByTagName("body")[0].style.overflow="hidden";let l=document.getElementById(`modal_${i}`);l.style.display="block",l.querySelector("iframe").classList.add("slide-down"),player&&player.pause()})})},(()=>{let t=document.querySelector("title");if(!t)return;let i=t.textContent,o=t.getAttribute("data-blur");if(o===null||o.length===0)return;let n=!1;window.addEventListener("blur",()=>{n||(n=!0,t.textContent=o,setTimeout(function a(){n&&(t.textContent=t.textContent===o?"(1) "+i:o,setTimeout(a,1500))},1500))}),window.addEventListener("focus",()=>{n&&(n=!1,t.textContent=i)})})();let forms=document.querySelectorAll("form");function post(t,i){return fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Object.fromEntries(i))})}async function getRecaptchaToken(t){return new Promise((i,o)=>{grecaptcha.ready(()=>{grecaptcha.execute(t,{action:"submit"}).then(i).catch(o)})})}async function handleForm(t){document.dispatchEvent(new CustomEvent("on-form-submit",{detail:{form:t,form_id:t.getAttribute("id")}}));let i=t.querySelector("[data-form-error-message]"),o=t.querySelector("[data-form-success-message]");i&&(i.style.display="none"),o&&(o.style.display="none");let n=null,a=null,r=t.querySelector('button[type="submit"]'),l=r.innerHTML;r||(n=t.querySelector('input[type="submit"]'),a=n.value),n?(n.value="Loading...",n.disabled=!0):r&&(r.innerHTML="Loading...",r.disabled=!0);let c=new FormData(t);c.append("_csrf",window.csrf_token);let s=null,p=t.querySelector('[data-recaptcha-v3="true"]');if(p){const d=await getRecaptchaToken(p.getAttribute("data-site-key"));c.append("g-recaptcha-response",d)}try{s=await post(t.getAttribute("action"),c);let d=await s.json();if(s.status==200){document.dispatchEvent(new CustomEvent("on-form-success",{detail:{form:t,form_id:t.getAttribute("id"),response:d}}));let u=t.getAttribute("data-redirect-url"),m=t.getAttribute("data-success-message"),g=t.getAttribute("data-open-modal");if(u)return document.dispatchEvent(new CustomEvent("form-submitted",{detail:{form:t}})),void(window.location.href=decodeURIComponent(u));if(g){let w=document.querySelector(`#${g}`);w&&(w.style.display="block"),t.reset()}else o&&m&&(o.textContent=decodeURIComponent(m),o.style.display="block"),t.reset()}s.status==400&&i&&(document.dispatchEvent(new CustomEvent("on-form-error",{detail:{form:t,form_id:t.getAttribute("id"),response:d}})),i.innerHTML=d.error||d.errors.join("<br />"),i.style.display="block")}catch(d){console.log(d),i.innerHTML="There was an error submitting the form. Please try again later.",i.style.display="block"}n?(n.value=a,n.disabled=!1):r&&(r.innerHTML=l,r.disabled=!1)}function trackPageSwitchedTab(t){let i=window.fid,o=window.fnid,n=window.pgid,a=window.bid,r=window.location.href;r=r.replace(window.location.origin,"");let l={fid:i,fnid:o,pgid:n,bid:a,url:r,time:timeOnPage,switched_back:t};l=addUtmParams(l);for(let c in TrackingListeners)TrackingListeners[c].tabSwitched(l)}forms.forEach(t=>{let i=t.getAttribute("action");if(i&&i.indexOf("/api")===0){let o=document.createElement("input");o.type="hidden",o.name="_csrf",o.value=window.csrf_token,t.appendChild(o);let n=t.querySelector('[data-recaptcha-v3="true"]');if(n){const a=n.getAttribute("data-site-key");if(a){const r=document.createElement("script");r.src=`https://www.google.com/recaptcha/api.js?render=${a}`,document.head.appendChild(r)}else console.error("Site key is missing.")}t.addEventListener("submit",a=>{a.preventDefault(),handleForm(t)})}});const trackTabChanges=()=>{let t="hidden",i=document[t];document.addEventListener("visibilitychange",()=>{i===document[t]||window.page_exit_tracked||(document[t]?trackPageSwitchedTab(!1):trackPageSwitchedTab(!0),i=document[t])})};function trackElementsHover(){document.querySelectorAll(["h1","h2","h3","button","a","p","span","li","b",'input[type="submit"]'].join(",")).forEach(t=>{addCustomEventListener(t,"mouseover",i=>{new Date().getTime(),t.setAttribute("data-hovered",!0),setTimeout(()=>{if(t.hasAttribute("data-hovered")&&!t.hasAttribute("data-hovered-sent")){t.setAttribute("data-hovered-sent",!0);let o=window.fid,n=window.fnid,a=window.pgid,r=window.bid,l=window.location.href;l=l.replace(window.location.origin,"");let c=t.innerText;c=c.substring(0,50)+(c.length>50?"...":"");let s={fid:o,fnid:n,pgid:a,bid:r,url:l,time:timeOnPage,tag:t.tagName.toLowerCase(),text:c};s=addUtmParams(s);for(let p in TrackingListeners)TrackingListeners[p].elementHover(s)}},200)}),addCustomEventListener(t,"mouseout",i=>{t.removeAttribute("data-hovered")})})}function trackFormStart(){document.querySelectorAll(['input[type="text"]','input[type="number"]','input[type="email"]',"textarea"].join(",")).forEach(t=>{addCustomEventListener(t,t.tagName.toLowerCase()==="select"?"change":"keyup",i=>{let o=t.closest("form");if(o&&!o.hasAttribute("data-form-started")){o.setAttribute("data-form-started",!0);let n={tag:t.tagName.toLowerCase()};n=addUtmParams(n);for(let a in TrackingListeners)TrackingListeners[a].formStart(n)}})})}class ViewportTimeTracker{constructor(){this.componentTimes=new Map,this.observer=null,this.updateInterval=null,this.init()}init(){this.observer=new IntersectionObserver(i=>{i.forEach(o=>{const n=o.target.getAttribute("data-cid");if(!n)return;const a=Date.now();o.isIntersecting?this.startTracking(n,a):this.stopTracking(n,a)})},{threshold:.1,rootMargin:"0px"}),this.observeComponents(),this.updateInterval=setInterval(()=>{this.updateVisibleComponents()},1e3),window.addEventListener("beforeunload",()=>{this.sendAllViewportTimes()}),setInterval(()=>{this.sendViewportTimes()},3e4)}observeComponents(){document.querySelectorAll("[data-cid]").forEach(i=>{this.observer.observe(i);const o=i.getAttribute("data-cid");this.componentTimes.has(o)||this.componentTimes.set(o,{startTime:null,totalTime:0,isVisible:!1,lastUpdate:Date.now(),element:i})})}startTracking(i,o){const n=this.componentTimes.get(i);n&&!n.isVisible&&(n.startTime=o,n.isVisible=!0,n.lastUpdate=o,console.log(`Started tracking component ${i} at ${o}`))}stopTracking(i,o){const n=this.componentTimes.get(i);if(n&&n.isVisible&&n.startTime){const a=o-n.startTime;n.totalTime+=a,n.isVisible=!1,n.startTime=null,n.lastUpdate=o,console.log(`Stopped tracking component ${i}, added ${a}ms, total: ${n.totalTime}ms`)}}updateVisibleComponents(){const i=Date.now();this.componentTimes.forEach((o,n)=>{if(o.isVisible&&o.startTime){const a=i-o.lastUpdate;o.totalTime+=a,o.lastUpdate=i}})}sendViewportTimes(){this.componentTimes.forEach((i,o)=>{i.totalTime>1e3&&(this.sendViewportTimeEvent(o,i),i.totalTime=0)})}sendAllViewportTimes(){const i=Date.now();this.componentTimes.forEach((o,n)=>{if(o.isVisible&&o.startTime){const a=i-o.startTime;o.totalTime+=a}}),this.componentTimes.forEach((o,n)=>{o.totalTime>500&&this.sendViewportTimeEvent(n,o,!0)})}sendViewportTimeEvent(i,o,n=!1){const a=o.element;if(!a)return;let r=window.location.href;r=r.replace(window.location.origin,"");let l={cid:i,sid:a.getAttribute("data-sid"),fid:window.fid,fnid:a.getAttribute("data-fnid")||window.fnid,pgid:window.pgid,bid:window.bid,url:r,time:window.timeOnPage,viewport_time:Math.round(o.totalTime/1e3),event_type:n?"viewport_time_exit":"viewport_time"};const c=this.extractAIContext(a);c.contentType&&(l.content_type=c.contentType,l.psychology_intent=c.psychologyIntent,l.custom_tags=c.customTags,l.attention_quality=this.calculateAttentionQuality(o,a),l.scroll_within_component=this.calculateScrollDepth(a),l.engagement_score=this.calculateEngagementScore(o,c)),l=addUtmParams(l),console.log(`Sending viewport time event for component ${i}:`,l),sendViewportTimeEvent(l)}extractAIContext(i){const o={contentType:i.dataset.aiContentType||null,psychologyIntent:i.dataset.aiPsychology||null,customTags:{}};return Object.keys(i.dataset).forEach(n=>{if(n.startsWith("ai")&&!["aiContentType","aiPsychology"].includes(n)){const a=n.replace(/^ai/,"").toLowerCase();o.customTags[a]=i.dataset[n]}}),o}calculateAttentionQuality(i,o){const n=i.totalTime/1e3,a=this.calculateScrollDepth(o);return n>10&&a>70?"focused":n<3||a<30?"distracted":"scanning"}calculateScrollDepth(i){const o=i.getBoundingClientRect(),n=window.innerHeight;if(o.top>=n||o.bottom<=0)return 0;const a=Math.max(0,-o.top),r=Math.min(o.height,n-o.top)-a;return Math.round(r/o.height*100)}calculateEngagementScore(i,o){let n=0;const a=i.totalTime/1e3;n+=Math.min(4,a/10);const r=this.calculateScrollDepth(i.element);return n+=r/100*2,o.contentType==="testimonial"&&a>15||o.contentType==="faq"&&r>80?n+=1:o.contentType==="science"&&a>20&&(n+=1.5),Math.min(10,Math.round(10*n)/10)}getComponentViewportTime(i){const o=this.componentTimes.get(i);if(!o)return 0;let n=o.totalTime;return o.isVisible&&o.startTime&&(n+=Date.now()-o.startTime),Math.round(n/1e3)}getAllComponentTimes(){const i={};return this.componentTimes.forEach((o,n)=>{i[n]=this.getComponentViewportTime(n)}),i}}let viewportTracker=null;function initViewportTimeTracking(){return viewportTracker||(viewportTracker=new ViewportTimeTracker,window.viewportTracker=viewportTracker),viewportTracker}function getUrlParams(){let t={};return window.location.search.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(i,o,n){t[o]=n}),t}function addUtmParams(t){const i=getUrlParams();return i.utm_source&&(t.utm_source=i.utm_source),i.utm_medium&&(t.utm_medium=i.utm_medium),i.utm_campaign&&(t.utm_campaign=i.utm_campaign),i.utm_term&&(t.utm_term=i.utm_term),i.utm_content&&(t.utm_content=i.utm_content),t}function extractAIContextFromComponent(t){const i={contentType:t.dataset.aiContentType||null,psychologyIntent:t.dataset.aiPsychology||null,customTags:{}};return Object.keys(t.dataset).forEach(o=>{if(o.startsWith("ai")&&!["aiContentType","aiPsychology"].includes(o)){const n=o.replace(/^ai/,"").toLowerCase();i.customTags[n]=t.dataset[o]}}),i}function calculatePsychologySignals(t,i,o){const n={},a=o.toLowerCase();return t.contentType!=="faq"&&t.psychologyIntent!=="reduce-skepticism"||(n.skepticism_signal="high",n.trust_seeking=!0,n.resolution_intent="active",a.includes("side effect")||a.includes("safe")||a.includes("harm")?n.objection_category="safety":a.includes("work")||a.includes("effective")||a.includes("result")?n.objection_category="efficacy":a.includes("price")||a.includes("cost")||a.includes("expensive")?n.objection_category="price":(a.includes("shipping")||a.includes("delivery")||a.includes("arrive"))&&(n.objection_category="shipping")),t.contentType!=="testimonial"&&t.psychologyIntent!=="build-trust"||(n.trust_seeking=!0,n.social_validation_seeking=!0),(t.contentType==="science"||a.includes("study")||a.includes("research")||a.includes("proven"))&&(n.credibility_seeking=!0,n.authority_validation=!0),(t.contentType==="pricing"||a.includes("price")||a.includes("$")||a.includes("buy"))&&(n.price_sensitivity="high",n.value_assessment=!0),(t.contentType==="guarantee"||a.includes("guarantee")||a.includes("refund")||a.includes("money back"))&&(n.risk_aversion="high",n.safety_seeking=!0),n}window.timeOnPage=0,setInterval(()=>{document.hasFocus()&&window.timeOnPage++},1e3);const trackPageExitEvent=function(){let t=window.fid,i=window.fnid,o=window.pgid,n=window.bid,a=window.location.href;a=a.replace(window.location.origin,"");let r={fid:t,fnid:i,pgid:o,bid:n,url:a,time:timeOnPage};window.page_exit_tracked=!0,r=addUtmParams(r),sendPageExitEvent(r)},trackPageView=function(){let t=window.fid,i=window.fnid,o=window.pgid,n=window.bid,a=window.location.href;a=a.replace(window.location.origin,"");let r={fid:t,fnid:i,pgid:o,bid:n,url:a,time:timeOnPage,referrer:document.referrer||void 0,referrer_domain:document.referrer?new URL(document.referrer).hostname:void 0};r=addUtmParams(r),sendPageViewEvent(r)},trackPageScroll=function(){let t=window.fid,i=window.fnid,o=window.pgid,n=window.bid,a=window.location.href;a=a.replace(window.location.origin,"");let r={fid:t,fnid:i,pgid:o,bid:n,url:a,time:timeOnPage,scroll_y:window.scrollY};r=addUtmParams(r),sendPageScrollEvent(r)},trackComponentClickEvent=function(t,i){if(t.tagName==="A"&&(t.getAttribute("href")==="#"||t.getAttribute("href")==="javascript:;"||t.getAttribute("href")?.startsWith("/b")))return;let o=i.getAttribute("data-cid"),n=i.getAttribute("data-sid"),a=window.fid,r=i.getAttribute("data-fnid"),l=window.pgid,c=window.bid,s=t.href??"";s=s.replace(window.location.origin,"");let p=window.location.href;p=p.replace(window.location.origin,"");let d="unknown",u="";t.tagName==="A"?(d="link",u=t.innerText||t.textContent||""):t.tagName==="BUTTON"?(d="button",u=t.innerText||t.textContent||""):t.hasAttribute("data-accordion-title")||t.classList.contains("accordion-title")?(d="accordion",u=t.innerText||t.textContent||""):t.hasAttribute("role")?(d=t.getAttribute("role"),u=t.innerText||t.textContent||t.getAttribute("aria-label")||""):t.hasAttribute("data-toggle")?(d="toggle",u=t.innerText||t.textContent||""):(d="interactive",u=t.innerText||t.textContent||"");let m={cid:o,sid:n,fid:a,fnid:r,pgid:l,bid:c,text:u.trim(),href:s,url:p,time:timeOnPage,element_type:d};const g=extractAIContextFromComponent(i);if(g.contentType){m.content_type=g.contentType,m.psychology_intent=g.psychologyIntent,m.custom_tags=g.customTags;const f=calculatePsychologySignals(g,t,u);Object.assign(m,f)}let w=!1;if(t.tagName==="A"&&t.href)try{new URL(t.href).hostname!==window.location.hostname&&(w=!0)}catch(f){console.log("Error parsing link",f)}m.funnel_click=w,m.href_code=t.getAttribute("data-href-code")??null,m=addUtmParams(m),sendClickEvent(m)},trackClickEvent=function(t){if(t.tagName==="A"&&(t.getAttribute("href")==="#"||t.getAttribute("href")==="javascript:;"||!t.getAttribute("href")&&!t.hasAttribute("role")&&!t.hasAttribute("data-toggle")))return;let i=window.fid,o=window.pgid,n=window.bid,a=t.href??"";a=a.replace(window.location.origin,"");let r=window.location.href;r=r.replace(window.location.origin,"");let l="unknown",c="";t.tagName==="A"?(l="link",c=t.innerText||t.textContent||""):t.tagName==="BUTTON"?(l="button",c=t.innerText||t.textContent||""):t.hasAttribute("data-accordion-title")||t.classList.contains("accordion-title")?(l="accordion",c=t.innerText||t.textContent||""):t.hasAttribute("role")?(l=t.getAttribute("role"),c=t.innerText||t.textContent||t.getAttribute("aria-label")||""):t.hasAttribute("data-toggle")?(l="toggle",c=t.innerText||t.textContent||""):(l="interactive",c=t.innerText||t.textContent||"");let s={fid:i,pgid:o,bid:n,text:c.trim(),href:a,url:r,time:timeOnPage,element_type:l};s=addUtmParams(s);let p=!1;if(t.tagName==="A"&&t.href)try{new URL(t.href).hostname!==window.location.hostname&&(p=!0)}catch(d){console.log("Error parsing link",d)}s.funnel_click=p,s.href_code=t.getAttribute("data-href-code")??null,sendClickEvent(s)},trackAllClicks=()=>{addCustomEventListener(document,"click",t=>{let i=t.target,o=i.closest('a, button, [role="button"], [role="tab"], [tabindex], .clickable, [data-toggle], [data-accordion-title]');if(!o){let a=i.closest("[onclick], [data-click], .interactive, .toggle, .tab, .accordion-title");a&&(o=a)}if(!o)return;let n=t.target.closest("[data-cid]");n?trackComponentClickEvent(o,n):(o.tagName==="BUTTON"||o.tagName==="A"&&o.getAttribute("href")||o.hasAttribute("role")||o.hasAttribute("data-toggle")||o.classList.contains("clickable")||o.classList.contains("interactive"))&&trackClickEvent(o)})};document.addEventListener("DOMContentLoaded",function(){trackAllClicks(),watchBuyButtons(),trackTabChanges(),trackElementsHover(),trackFormStart(),initViewportTimeTracking(),(window.t||[]).forEach(t=>{startTracking(t[0],t[1])}),trackPageView(),window.addEventListener("beforeunload",trackPageExitEvent)});let scrollTimer=null;window.addEventListener("scroll",function(){scrollTimer&&clearTimeout(scrollTimer),scrollTimer=setTimeout(function(){trackPageScroll()},300)});let splitTestManager=null;async function getSplitTestManager(){if(!splitTestManager)try{const{default:t}=await __vitePreload(async()=>{const{default:i}=await import("./DeterministicSplitTestManager-BmSSdnfg.js");return{default:i}},[]);splitTestManager=t,splitTestManager.setDebugEnabled(1);try{const i=typeof window<"u"&&new URLSearchParams(window.location.search).has("debug112");splitTestManager&&splitTestManager.setDebugEnabled&&splitTestManager.setDebugEnabled(i)}catch{}}catch{console.warn("DeterministicSplitTestManager not available, falling back to random selection"),splitTestManager=null}return splitTestManager}function trigger_split_test_result(t,i={}){console.log("Trigger trigger_split_test_result",t),t.type==="exit_popup"&&(i.exitpopup_id=parseInt(t.data.value));let o={fid:window.fid,pgid:window.pgid,bid:window.bid,fnid:t.step_id,url:window.location.href,sid:t.data.sid,...i};window.sids=window.sids||[],window.sids.push(t.data.sid),trackCustomEvent("split-test-view",o)}async function determine_split_result(t,i){const o=[];let n=null;if(typeof window<"u"&&new URLSearchParams(window.location.search).has("debug112")&&console.log("[SplitTest] determine_split_result start",{split_test_id:t?.data?.split_test_id,winner_node_code:t?.data?.winner_node_code}),i.req?i.req.cookies[`st_res_${t.data.split_test_id}`]&&(n=i.req.cookies[`st_res_${t.data.split_test_id}`]):check_cookie(`st_res_${t.data.split_test_id}`)&&(n=get_cookie$1(`st_res_${t.data.split_test_id}`)),t.data.winner_node_code){let r=find_next_by_step_id(t,t.data.winner_node_code);if(r)return typeof window<"u"&&new URLSearchParams(window.location.search).has("debug112")&&console.log("[SplitTest] winner_node_code active, short-circuit to winner",{winner_node_code:t.data.winner_node_code}),r.next[0]}t.next.forEach(function(r){o.push({step_id:r.next[0].step_id,step:r.next[0],weight:parseFloat(r.data.value)})});try{console.log("[SplitTest] prepared steps",o.map(r=>({node_code:r.step?.node_code,weight:r.weight})))}catch{}if(n){let r=find_next_by_step_id(t,n);if(r)return typeof window<"u"&&new URLSearchParams(window.location.search).has("debug112")&&console.log("[SplitTest] existing session result found, reusing",{split_test_id:t.data.split_test_id,node_code:n}),r}try{const r=o.map(l=>({node_code:l.step?.node_code,weight:l.weight}));typeof window<"u"&&new URLSearchParams(window.location.search).has("debug112")&&console.log("[SplitTest] candidates prepared",{split_test_id:t.data.split_test_id,candidates:r})}catch{}try{const r=await getSplitTestManager();if(typeof window<"u"&&new URLSearchParams(window.location.search).has("debug112")&&console.log("[SplitTest] deterministic manager",{available:!!r}),!r&&i&&i.req&&i.req.query&&i.req.query.debug112==="1"&&console.log("[SplitTest] deterministic manager not available in backend"),r){const l=await r.getNextStep(t.data.split_test_id,o);if(l){const c=l.step;return typeof window<"u"&&new URLSearchParams(window.location.search).has("debug112")&&console.log("[SplitTest] deterministic outcome",{split_test_id:t.data.split_test_id,node_code:c?.node_code}),i&&i.req&&i.req.query&&i.req.query.debug112==="1"&&console.log("[SplitTest] deterministic outcome (backend)",{split_test_id:t.data.split_test_id,node_code:c?.node_code}),i.req?(i.res.cookie(`st_res_${t.data.split_test_id}`,c.node_code,{maxAge:6048e5,httpOnly:!0}),i.req.cookies[`st_res_${t.data.split_test_id}`]=c.node_code):set_cookie(`st_res_${t.data.split_test_id}`,c.node_code,null,!0),c}}}catch(r){console.warn("Deterministic split test failed, falling back to random:",r.message)}let a=function(r,l){const c=new Date;var s;const p=function(u,m){for(const g of m)if(u>=g.startMinute&&u<=g.endMinute)return g.adjustments;return null}(60*(s=c).getHours()+s.getMinutes(),l);let d=r;return p&&typeof p=="object"&&(d=r.map(u=>({...u,weight:p[u.step_id]!==void 0?parseFloat(p[u.step_id]):u.weight}))),function(u){const m=u.filter(_=>typeof _.weight=="number"&&_.weight>0),g=m.length>0?m:u,w=g.reduce((_,h)=>_+Math.max(0,typeof h.weight=="number"?h.weight:0),0);if(w<=0)return g[0].step;let f=Math.random()*w,y=0;for(const _ of g)if(y+=Math.max(0,typeof _.weight=="number"?_.weight:0),f<=y)return _.step;return g[g.length-1].step}(d)}(o,[]);return typeof window<"u"&&new URLSearchParams(window.location.search).has("debug112")&&console.log("[SplitTest] fallback random outcome",{split_test_id:t.data.split_test_id,node_code:a?.node_code}),i&&i.req&&i.req.query&&i.req.query.debug112==="1"&&console.log("[SplitTest] fallback random outcome (backend)",{split_test_id:t.data.split_test_id,candidates:o.map(r=>({node_code:r.step?.node_code,weight:r.weight})),node_code:a?.node_code}),i.req?(i.res.cookie(`st_res_${t.data.split_test_id}`,a.node_code,{maxAge:6048e5,httpOnly:!0}),i.req.cookies[`st_res_${t.data.split_test_id}`]=a.node_code):set_cookie(`st_res_${t.data.split_test_id}`,a.node_code,null,!0),a}async function wait(t){return new Promise((i,o)=>{setTimeout(()=>{i()},1e3*t)})}async function asyncForEach(t,i,o=!1){for(let n=0;n<t.length;n++){if(o)return;await i(t[n],n,t,o)}}function get_next_step(t,i){return t.next&&t.next.length>i?t.next[i]:null}function find_next_by_step_id(t,i){if(t.step_id==i||t.node_code==i)return t;if(t.next&&t.next.length>0)for(let o=0;o<t.next.length;o++){let n=find_next_by_step_id(t.next[o],i);if(n)return n}return null}function find_node_in_flow(t,i){if(!t||t.length===0)return null;if(t.flow&&Array.isArray(t.flow))return find_node_in_flow(t.flow,i);for(let o of t){if(o.id===i)return o;if(o.next&&o.next.length>0){let n=find_node_in_flow(o.next,i);if(n)return n}if(o.recursive&&o.recursive_id===i)return o}return null}async function processBaseFunnelNode(t,i={},o=[]){if(!t)return;sendFunnelNodeEvent({...t,...i});let n=t;if(!t.type||t===null)return t;let a=!1;for(;t&&!a;)switch(t.type){case"recursive":console.log("recursive",t);let r=null;if(typeof window<"u")r=window.page_events;else if(i.funnelService&&i.funnelService.funnel&&i.funnelService.funnel.flow){if(r=i.funnelService.funnel.flow,typeof r=="string")try{r=JSON.parse(r)}catch(c){console.error("Failed to parse flow data JSON:",c),r=null}}else if(i.flow&&(r=i.flow,typeof r=="string"))try{r=JSON.parse(r)}catch(c){console.error("Failed to parse opts.flow data JSON:",c),r=null}if(console.log("Flow data available:",!!r),console.log("currentNode.recursive_id",t.recursive_id),t.recursive_id&&t.recursive_id!==t.id&&r){let c=find_node_in_flow(r,t.recursive_id);if(c&&c.id!==t.id)typeof window<"u"&&["script_rule","dynamic_container","page_variant","product_check"].includes(c.type)?(t=null,a=!0):(console.log("recursiveNode",c),t=c);else{let s=get_next_step(t,0);s?t=s:(t=null,a=!0)}}else{let c=get_next_step(t,0);c?t=c:(t=null,a=!0)}break;case"wait":a=!0,wait(t.data.value).then(c=>{i.callback&&i.callback(c),processBaseFunnelNode(t=get_next_step(t,0),i)});break;case"entry":t=get_next_step(t,0);break;default:let l=null;if(t&&t.type&&await asyncForEach(o,async c=>{if(t)return c.type===t.type?(l=await c.process(t,i,o),l&&(t=l),t):void 0}),n!=t&&sendFunnelNodeEvent({...t,...i}),l==null){t=null;break}}n!=t&&sendFunnelNodeEvent({...t,...i})}async function show_exit_popup(t){if(parseInt(t)!=t)return;let i=document.querySelectorAll('[data-modal="true"]'),o=!1;if(i.forEach(s=>{s.style.display==="block"&&(o=!0)}),o)return;let n=document.getElementById("exit_popup_"+t),a=function(s,p=0){let d=document.getElementById("exit_"+s);d?(d.style.display="block",d.querySelector("*[data-modal]")&&(d.querySelector("*[data-modal]").style.display="block"),d.querySelectorAll('[data-modal-close="true"], [data-action="close-exitpopup"]').forEach(u=>{u.addEventListener("click",m=>{d.style.display="none",d.querySelector("*[data-modal]").style.display="none"})}),d.querySelectorAll("form").forEach(u=>{let m=u.getAttribute("action");m&&m.indexOf("/api")===0&&u.addEventListener("submit",g=>{g.preventDefault(),handleForm(u)})})):p<5?setTimeout(()=>{a(s,p++)},50):console.error("Exit popup not found: "+s)};if(n){let s=document.getElementById("exit_"+t);return s.style.display="block",console.log("exit.querySelector('*[data-modal]')",s.querySelector("*[data-modal]")),s.querySelector("*[data-modal]")&&(s.querySelector("*[data-modal]").style.display="block"),void a(t)}n=document.createElement("script");const r=window.pgid?`&pg=${window.pgid}`:"",l=window.fid?`&fid=${window.fid}`:"",c=window.fnid?`&fnid=${window.fnid}`:"";n.src=`/ex/${t}?b=${bid}${r}${l}${c}`,n.async=!0,n.id="exit_popup_"+t,n.onload=()=>{setTimeout(()=>{a(t)},10)},document.body.appendChild(n)}function addExitScriptTags$1(t){if(t.type=="exit_popup"){let i=document.createElement("script");const o=window.pgid?`&pg=${window.pgid}`:"",n=window.fid?`&fid=${window.fid}`:"",a=window.fnid?`&fnid=${window.fnid}`:"";i.src=`/ex/${t.data.value}?b=${bid}${o}${n}${a}`,i.async=!0,document.body.appendChild(i)}t.next&&t.next.length>0&&t.next.forEach(i=>{addExitScriptTags$1(i)})}function on_exit_intent(t){let i;document.querySelector("body").addEventListener("mouseleave",o=>{i=o.clientY,i<0&&t()})}function listen_exit_intent(t=null){t||(t=window.page_events.find(i=>i.type=="exit_intent")),t&&(addExitScriptTags$1(t),on_exit_intent(function(){processFunnelNode(t.next[0]).then(()=>{})}))}const isMobile=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),MOBILE_EXIT_CONFIG={fastScrollThreshold:.8,velocityTimeWindow:100,minScrollDistance:50,debounceTime:2e3,directionChangeThreshold:3};let scrollState={lastScrollY:0,lastScrollTime:0,scrollVelocity:0,fastScrollCount:0,directionChanges:0,lastDirection:null,isTriggered:!1,lastTriggerTime:0},mobileExitIntentInitialized=!1;function addExitScriptTags(t){if(t.type=="exit_popup"){let i=document.createElement("script");const o=window.pgid?`&pg=${window.pgid}`:"",n=window.fid?`&fid=${window.fid}`:"",a=window.fnid?`&fnid=${window.fnid}`:"";i.src=`/ex/${t.data.value}?b=${bid}${o}${n}${a}`,i.async=!0,document.body.appendChild(i)}t.next&&t.next.length>0&&t.next.forEach(i=>{addExitScriptTags(i)})}function on_mobile_exit_intent(t){if(!isMobile)return;if(mobileExitIntentInitialized)return void console.log("Mobile exit intent already initialized, skipping");mobileExitIntentInitialized=!0,console.log("Initializing mobile exit intent");let i,o,n=0,a=0,r=!1;function l(){const s=scrollState.fastScrollCount>=2,p=scrollState.directionChanges>=MOBILE_EXIT_CONFIG.directionChangeThreshold;!s&&!p||scrollState.isTriggered||(scrollState.isTriggered=!0,scrollState.lastTriggerTime=Date.now(),window.console&&window.console.log&&console.log("Mobile exit intent triggered:",{fastScrollCount:scrollState.fastScrollCount,directionChanges:scrollState.directionChanges,velocity:scrollState.scrollVelocity}),t())}function c(){scrollState.fastScrollCount=0,scrollState.directionChanges=0,scrollState.lastDirection=null,scrollState.scrollVelocity=0}document.addEventListener("touchstart",s=>{n=s.touches[0].clientY,r=!1},{passive:!0}),document.addEventListener("touchmove",s=>{r||(r=!0,a=s.touches[0].clientY)},{passive:!0}),document.addEventListener("touchend",s=>{r&&(a=s.changedTouches[0].clientY,Math.abs(a-n)>MOBILE_EXIT_CONFIG.minScrollDistance&&l())},{passive:!0}),window.addEventListener("scroll",()=>{const s=window.pageYOffset,p=Date.now();if(p-scrollState.lastTriggerTime<MOBILE_EXIT_CONFIG.debounceTime)return;const d=s-scrollState.lastScrollY,u=p-scrollState.lastScrollTime;u>0&&(scrollState.scrollVelocity=Math.abs(d)/u);const m=d>0?"down":"up";scrollState.lastDirection&&scrollState.lastDirection!==m&&scrollState.directionChanges++,scrollState.lastDirection=m,scrollState.lastScrollY=s,scrollState.lastScrollTime=p,scrollState.scrollVelocity>MOBILE_EXIT_CONFIG.fastScrollThreshold&&scrollState.fastScrollCount++,clearTimeout(i),i=setTimeout(()=>{l(),c()},MOBILE_EXIT_CONFIG.velocityTimeWindow)},{passive:!0}),window.addEventListener("orientationchange",()=>{setTimeout(()=>{c(),scrollState.isTriggered=!1},300)}),document.addEventListener("visibilitychange",()=>{document.hidden&&(clearTimeout(o),o=setTimeout(()=>{scrollState.isTriggered=!1},3e4))})}function listen_mobile_exit_intent(t=null){isMobile&&(t||(t=window.page_events.find(i=>i.type=="mobile_exit_intent")),t&&(addExitScriptTags(t),on_mobile_exit_intent(function(){processFunnelNode(t.next[0]).then(()=>{})})))}async function processFunnelNode(t,i){return console.log("processFunnelNode",t,i),await processBaseFunnelNode(t,i,[{type:"has_tag",process:(n,a={},r=[])=>{let l=check_cookie(n.data.value);return a.callback&&a.callback("has_tag",l),n=get_next_step(n,l?0:1)}},{type:"add_tag",process:(n,a={},r=[])=>(a.callback&&a.callback("add_tag",n.data.value),set_cookie(`tag_${n.data.value}`,1,null,!0),n=get_next_step(n,0))},{type:"affiliate_whitelisted",process:async(n,a={},r=[])=>{let l=new URLSearchParams(window.location.search).get("aff_id");return get_next_step(n,l&&check_cookie("aff_w_"+l)?0:1)}},{type:"url_redirect",process:async(n,a={},r=[])=>(location.href=n.data.value,null)},{type:"exit_intent",process:async(n,a={},r=[])=>(await listen_exit_intent(n),null)},{type:"mobile_exit_intent",process:async(n,a={},r=[])=>(await listen_mobile_exit_intent(n),null)},{type:"exit_popup",process:async(n,a={},r=[])=>(await show_exit_popup(n.data.value).then(l=>{a.callback&&a.callback("exit_popup",l)}),null)},{type:"video_is_muted",process:async(n,a={},r=[])=>{let l=window.player_is_muted??!1;return window.tp&&(l=window.tp.isMuted()),n=get_next_step(n,l?0:1)}},{type:"video_pause",process:async(n,a={},r=[])=>(window.tp&&window.tp.pause(),window.pauseVideo&&window.pauseVideo(),n=get_next_step(n,0))},{type:"video_watched_seconds",process:async(n,a={},r=[])=>{let l=window.current_player_time??void 0;return window.tp&&(l=window.tp.getCurrentTime()),n=l<parseInt(n.data.value)||l==null?get_next_step(n,1):get_next_step(n,0)}},{type:"when_scrolled_to",process:async(n,a={},r=[])=>{let l=n.data.value,c=()=>{window.scrollY>=l&&(processFunnelNode(n=get_next_step(n,0),a),window.removeEventListener("scroll",c))};window.addEventListener("scroll",c)}},{type:"showed_cta",process:async(n,a={},r=[])=>(console.log("showed_cta",window.showed_video_cta??!1),n=window.showed_video_cta?get_next_step(n,0):get_next_step(n,1))},{type:"wait_seconds",process:async(n,a={},r=[])=>(console.log("wait-seconds",n.data.value),await new Promise(l=>setTimeout(l,1e3*n.data.value)),get_next_step(n,0))},{type:"show_element",process:async(n,a={},r=[])=>{console.log("show_element",n.data.value);let l=document.querySelector(n.data.value);return l?(l.style.display="block",get_next_step(n,0)):(console.error("Element not found",n.data.value),null)}},{type:"hide_element",process:async(n,a={},r=[])=>{console.log("hide_element",n.data.value);let l=document.querySelector(n.data.value);return l?(l.style.display="none",get_next_step(n,0)):(console.error("Element not found",n.data.value),null)}},{type:"split_test",process:async(n,a={},r=[])=>{let l=n.data.split_test_id;return(n=determine_split_result(n,a)).data.sid=l,a.req||trigger_split_test_result(n,a),n}},{type:"on-form-success",process:async(n,a={},r=[])=>{document.addEventListener("on-form-success",l=>{l.detail.form.getAttribute("id")==n.data.form&&processFunnelNode(n.next[0]).then(()=>{})})}},{type:"on-add-to-cart",process:async(n,a={},r=[])=>{document.addEventListener("on-add-to-cart",l=>{processFunnelNode(n.next[0]).then(()=>{})})}},{type:"mark_whitelisted",process:async(n,a={},r=[])=>(set_cookie("whtst",1,null,!0),n=get_next_step(n,0),console.log("currentNode",n),n)},{type:"mark_not_whitelisted",process:async(n,a={},r=[])=>(set_cookie("whtst","-1",null,!0),n=get_next_step(n,0))},{type:"is_whitelisted",process:async(n,a={},r=[])=>{let l=!get_cookie("whtst")||get_cookie("whtst")==1;return set_cookie({name:"whst"}),n=get_next_step(n,l?0:1)}},{type:"client_script",process:async(n,a={},r=[])=>{let l=document.createElement("script");return l.type="text/javascript",l.text=n.data.client_script,document.body.appendChild(l),n=get_next_step(n,0)}},{type:"sequence",process:async(n,a={},r=[])=>{let l=0,c=get_next_step(n,l);do await processBaseFunnelNode(c,a,r);while(c=get_next_step(n,l++))}}])}function listen_page_view(){window.page_events=window.page_events||[];let t=window.page_events.find(i=>i.type=="page_view");t&&t.next.forEach(i=>{processFunnelNode(i).then(()=>{})})}function openDebuggerKeyModal(){if(document.getElementById("debug-key-modal-overlay"))return;const t=document.createElement("div");t.id="debug-key-modal-overlay",t.style.position="fixed",t.style.inset="0",t.style.background="rgba(0,0,0,0.45)",t.style.display="flex",t.style.alignItems="center",t.style.justifyContent="center",t.style.zIndex="999999";const i=document.createElement("div");i.style.background="#ffffff",i.style.borderRadius="8px",i.style.boxShadow="0 10px 30px rgba(0,0,0,0.2)",i.style.width="min(90vw, 420px)",i.style.padding="20px",i.style.fontFamily="system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif";const o=document.createElement("div");o.textContent="Enable Debugger",o.style.fontSize="18px",o.style.fontWeight="600",o.style.marginBottom="10px";const n=document.createElement("div");n.textContent="Paste your debug key to enable the debugger for this session.",n.style.fontSize="13px",n.style.color="#444",n.style.marginBottom="14px";const a=document.createElement("input");a.type="text",a.placeholder="Debug key",a.autocomplete="off",a.style.width="100%",a.style.padding="10px 12px",a.style.border="1px solid #d1d5db",a.style.borderRadius="6px",a.style.outline="none",a.style.fontSize="14px",a.style.boxSizing="border-box";try{const d=localStorage.getItem("ef_debug_last_key");d&&(a.value=d)}catch{}const r=document.createElement("div");r.style.color="#b91c1c",r.style.fontSize="12px",r.style.marginTop="6px",r.style.display="none";const l=document.createElement("div");l.style.display="flex",l.style.gap="8px",l.style.marginTop="16px",l.style.justifyContent="flex-end";const c=document.createElement("button");c.textContent="Cancel",c.style.padding="8px 12px",c.style.background="#e5e7eb",c.style.border="1px solid #e5e7eb",c.style.borderRadius="6px",c.style.cursor="pointer",c.onclick=()=>document.body.removeChild(t);const s=document.createElement("button");function p(){const d=(a.value||"").trim();if(!d)return r.textContent="Please enter a debug key.",r.style.display="block",void a.focus();try{localStorage.setItem("ef_debug_last_key",d)}catch{}const u=encodeURIComponent(window.location.href),m=`/debugger?key=${encodeURIComponent(d)}&next=${u}`;window.location.assign(m)}s.textContent="Enable",s.style.padding="8px 12px",s.style.background="#111827",s.style.color="#ffffff",s.style.border="1px solid #111827",s.style.borderRadius="6px",s.style.cursor="pointer",s.onclick=p,a.addEventListener("keydown",d=>{d.key==="Enter"&&p(),d.key==="Escape"&&(d.stopPropagation(),document.body.removeChild(t))}),t.addEventListener("click",d=>{d.target===t&&document.body.removeChild(t)}),l.appendChild(c),l.appendChild(s),i.appendChild(o),i.appendChild(n),i.appendChild(a),i.appendChild(r),i.appendChild(l),t.appendChild(i),document.body.appendChild(t),setTimeout(()=>a.focus(),0)}window.mobileExitIntentDeviceChange=function(t){if(console.log("Mobile exit intent handling device change to:",t),mobileExitIntentInitialized=!1,scrollState&&(scrollState.isTriggered=!1,scrollState.fastScrollCount=0,scrollState.directionChanges=0,scrollState.lastDirection=null,scrollState.scrollVelocity=0,scrollState.lastTriggerTime=0),t==="mobilePortrait"){const i=window.page_events?window.page_events.find(o=>o.type=="mobile_exit_intent"):null;i&&(console.log("Reinitializing mobile exit intent for device change"),listen_mobile_exit_intent(i))}},window.processFunnelNode=processFunnelNode,(async()=>document.querySelectorAll('[data-dropdown="click"], [data-dropdown="hover"]').length>0&&await __vitePreload(()=>import("./dropdown-eek4IRMA.js"),[]))(),(async()=>document.querySelectorAll('[data-burger="burger"], [data-responsive-menu="burger"]').length>0&&await __vitePreload(()=>import("./responsive-menu-DpMeyJvw.js"),[]))(),(async()=>document.querySelectorAll(".accordion").length>0&&await __vitePreload(()=>import("./accordion-CFzhEqX1.js"),[]))(),(async()=>document.querySelectorAll(".survey").length>0&&await __vitePreload(()=>import("./survey-BhC4TCMu.js"),[]))(),(async()=>document.querySelectorAll(".live-order").length>0&&await __vitePreload(()=>import("./live-order-CpUawYwA.js"),[]))(),(async()=>document.querySelectorAll(".fade-in-viewport").length>0&&await __vitePreload(()=>import("./fade-in-cqSf94AV.js"),[]))(),(async()=>document.querySelectorAll("[data-seconds]").length>0&&await __vitePreload(()=>import("./countdown-DZRXQT3p.js"),[]))(),(async()=>document.querySelectorAll('[class*="parallax-"], [data-parallax-effect]').length>0&&await __vitePreload(()=>import("./parallax-DP9F3W88.js"),__vite__mapDeps([0])))(),(async()=>document.querySelectorAll('[data-modal="true"]').length>0&&await __vitePreload(()=>import("./modals-CpgF8Zi-.js"),[]))(),(async()=>document.querySelectorAll('[class*="animate-"]').length>0&&await __vitePreload(()=>import("./index-CBePbqM8.js"),__vite__mapDeps([1])))(),(async()=>document.querySelectorAll('[data-sliding-banners="true"]').length>0&&await __vitePreload(()=>import("./sliding-banners-0StMsWGO.js"),[]))(),(async()=>document.querySelectorAll("[data-slider-container]").length>0&&await __vitePreload(()=>import("./slider-Cpkuooi9.js"),[]))(),(async()=>(document.querySelectorAll("[data-bump-products], [data-bump-checkbox]").length>0||new URLSearchParams(window.location.search).get("bumps"))&&await __vitePreload(()=>import("./bump-products-B05dLuIc.js"),[]))(),(async()=>document.querySelectorAll(".checkout-personal-details, .checkout-cc-panel, [data-checkout-submit]").length>0&&(await __vitePreload(()=>import("./checkout-B7lRBPDn.js"),[]),await __vitePreload(()=>import("./tax-calculator-Bc0HEiBI.js"),[])))(),(async()=>document.querySelectorAll("#stripe-card-element, #nmi-card-element").length>0&&await __vitePreload(()=>import("./secure-payments-CpWyZI27.js"),[]))(),(async()=>document.querySelectorAll("form[data-abandon-track], form.checkout-form, form#checkout-form, .checkout-personal-details, .checkout-cc-panel").length>0&&await __vitePreload(()=>import("./abandon-tracking-BHtLjsoK.js"),[]))(),(async()=>document.querySelectorAll("[data-questions], [data-quiz]").length>0&&await __vitePreload(()=>import("./quiz-BkmfEzM5.js"),[]))(),(async()=>window.int&&window.int.some(t=>t.action&&t.action.startsWith("animate-"))&&await __vitePreload(()=>import("./animations-interactions-CMeSFqFz.js"),__vite__mapDeps([2])))(),(async()=>document.querySelectorAll("*[data-youtube-code], *[data-direct-link]").length>0&&await __vitePreload(()=>import("./player-Cq82qhM3.js"),[]))(),(async()=>{let t=0,i=setInterval(async()=>{document.querySelectorAll('.trackplay-container video, [id^="vidalytics"] video, #smartplayer video').length>0&&(clearInterval(i),await __vitePreload(()=>import("./video-tracking-CGJvvgSK.js"),[])),t++,t>5&&clearInterval(i)},1e3)})(),listen_page_view(),listen_mobile_exit_intent(),document.addEventListener("keydown",async t=>{if((t.ctrlKey||t.metaKey)&&t.shiftKey&&t.key==="F12"){if(t.preventDefault(),window.debug_enabled!==!0)return openDebuggerKeyModal(),!1;window.debugWindow||await __vitePreload(()=>import("./debug-window-DCW3x-f4.js"),__vite__mapDeps([3])),window.debugWindow&&window.debugWindow.toggle()}}),(async()=>{try{const t=localStorage.getItem("ef_debug_window_open")==="true",i=new URLSearchParams(window.location.search).get("debugbar")==="true";if((t||i)&&(window.debugWindow||await __vitePreload(()=>import("./debug-window-DCW3x-f4.js"),__vite__mapDeps([3])),window.debugWindow&&!window.debugWindow.isOpen&&window.debugWindow.toggle(),i)){const o=new URL(window.location.href);o.searchParams.delete("debugbar"),window.history.replaceState({},document.title,o.toString())}}catch(t){console.warn("Debug window auto-load failed",t)}})(),window.addEventListener("DOMContentLoaded",async()=>{try{const t=new URLSearchParams(window.location.search).get("debugbar")==="true";if((localStorage.getItem("ef_debug_window_open")==="true"||t)&&(window.debugWindow||await __vitePreload(()=>import("./debug-window-DCW3x-f4.js"),__vite__mapDeps([3])),window.debugWindow&&!window.debugWindow.isOpen&&window.debugWindow.toggle(),t)){const i=new URL(window.location.href);i.searchParams.delete("debugbar"),window.history.replaceState({},document.title,i.toString())}}catch(t){console.warn("Debug window DOMContentLoaded auto-load failed",t)}});export{__vitePreload as _,addUtmParams as a};
